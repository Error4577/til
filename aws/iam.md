# IAM
## IAMの概要
### IAMとは
AWS Identity and Access Managementは安全にAWSの操作を実施するための認証・認可の仕組み
- AWS利用者認証の実施
- アクセスポリシーの設定
- ユーザー個人またはグループ毎に設定

### ユーザー
#### ルートユーザー
AWSアカウントを作成する際に、最所に作成されるのがルートユーザーであり、通常の業務には利用しないアカウント
- AWSアカウント作成時に作られるIDアカウント
- 全てのAWSサービスとリソースを使用できる権限を有するユーザー
- 日常的なタスクはルートユーザーを使用しないことが強く推奨される

以下のようなルートユーザーにしかできない操作権限が存在する
- AWSルートアカウントのメールアドレスやパスワードの変更
- IAMユーザーの課金情報へのアクセスに関するactivate/deactivate
- 他のAWSアカウントへのRoute53のドメイン登録の移行
- CloudFrontのキーペア作成
- AWSサービスのキャンセル
- AWSアカウントの停止
- コンソリデイテッドビリングの設定
- 脆弱性診断フォームの提出
- 逆引きDNS申請

#### IAMユーザー
IAMポリシー内でAWSサービスを利用できるユーザー。  
基本操作はIAMユーザーで実施することになる。  

|設定上限|1アカウントで5000ユーザーまで作成可能|
|:--:|:--|
|設計内容|ユーザー名|
|^|パス(オプション)<br>ユーザーにオプションとしてセットできる情報<br>パスを元にユーザーの検索が可能<br>組織階層やプロジェクトなどをセット|
|^|所属グループ<br>10のグループまで設定が可能|
|^|パーミッション<br>AWSサービスへのアクセス権限|

IAMグループ


### IAMグループ
|設定上限|1アカウントで300グループまで作成可能|
|:--:|:--|
|設計内容|グループ名|
|^|パス(オプション)<br>組織階層などをセット|
|^|パーミッション<br>グループに設定したパーミッションは<br>IAMユーザーに付与したパーミッションと同時に評価|

### IAMポリシー
IAMポリシーを作成してユーザーなどへのアクセス権限を付与  
IAMポリシーはJSON形式で設定される  
|管理ポリシー|【AWS管理ポリシー】<br>AWSが作成および管理する管理ポリシー|
|--|--|
|^|【カスタム管理ポリシー】<br>AWSアカウントで作成・管理する管理ポリシー<br>同じポリシーを複数のIAMエンティティにアタッチできる|
|インラインポリシー|自身で作成および管理するポリシー<br>１つのプリンシパルエンティティ(ユーザー、グループ、またはロール)に<br>埋め込まれたポリシーで、<br>プリンシパルエンティティにアタッチすることができる|

### ロール
AWSリソースに対してアクセス権限をロールとして付与できる

## IAM設計
AWSを利用するユーザの役割やアクセス権限を自社の組織構造と合わせて設計することが重要

### IAM設計のベストプラクティス
ベストプラクティスに沿ったIAM設計をすることが望ましい
1. アカウント設定などの必要な場合の除いて、ルートユーザーを利用しない
2. ルートユーザーなどの特権ユーザーに対して、MFA を有効化する。
3. 利用者ごとにIAMユーザーを作成する
4. 組織利用の場合は、役割ごとのIAMグループを作成してグループで管理するのを基本とする
5. 最小限の権限設定と不要な認証情報は削除を心がける
6. ユーザーのために強度の高いパスワードポリシーを設定する。
7. EC2インスタンスで作動するアプリケーションなどプログラムから利用する場合はなるべく ロールを使用する。
8. モバイルやアプリケーションも含め、一時利用にはSTSなどで最小限の利用許可を与える
9. AWSアカウントのアクティビティの常に利用状況を監視する

## IAMグループへのポリシー適用

## IAMロールへのポリシー適用

## AWS Organizationの概要

## AWS Organizationの設定

責任共有モデル
[![Image from Gyazo](https://i.gyazo.com/6910a220f420abbc452d1c41e60c2118.jpg)](https://gyazo.com/6910a220f420abbc452d1c41e60c2118)
